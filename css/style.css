/* =======================
   GLOBAL & THEME
   ======================= */
:root{
  --bg:#fbf3e8;
  --surface:#f7ede2;
  --text:#1f2937;
  --muted:#6b7280;
  --brand:#0ea5b7;
  --accent:#ffd166;

  --radius:14px;
  --gap:16px;
  --header-h:64px;

  --shadow:0 10px 26px rgba(0,0,0,.14);
}

*{ box-sizing:border-box; }
html,body{ height:100%; }

/* ·∫®n scrollbar ngo√†i ‚Äì v·∫´n cho panel con cu·ªôn ƒë∆∞·ª£c */
html { overflow: hidden; }
body{
  margin:0;
  color:var(--text);
  background:var(--bg);
  font:16px/1.45 system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans", "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
}

/* =======================
   TOP BAR
   ======================= */
.topbar{
  height:var(--header-h);
  display:flex; align-items:center; justify-content:space-between;
  padding:0 var(--gap);
  background:#ffe4b5;
  border-bottom:2px solid #000;
}
.logo{ font-size:20px; font-weight:800; margin:0; }
.top-actions{ display:flex; align-items:center; gap:10px; }
.select, .btn, .btn-reset{
  height:36px; border:2px solid #000; border-radius:999px; background:#fff; padding:0 12px;
  font-weight:600; cursor:pointer;
}
.btn{ background:#fff; }
.btn:hover{ transform:translateY(-1px); }
.btn:active{ transform:translateY(0); }
.btn-reset{ background:#fff1c9; }

/* =======================
   SCALE ROOT ‚Äì (n·∫øu c·∫ßn scale to√†n trang)
   ======================= */
.scale-root{
  width:max-content;
  transform-origin: top center;
  margin:0 auto;
}

/* =======================
   MAIN GRID (3 columns)
   ======================= */
.main-grid{
  height:calc(100dvh - var(--header-h));
  display:grid;
  grid-template-columns: 260px minmax(540px,1fr) 320px; /* LEFT | CENTER | RIGHT */
  grid-template-areas: "left center right";
  gap: var(--gap);

  /* K√©o panel s√°t 2 m√©p tr√°i/ph·∫£i, ch·ªâ ch·ª´a gap gi·ªØa 3 c·ªôt */
  padding: var(--gap) 0;

  align-items: stretch;
  overflow: visible;

  --base-left:260;
  --base-center:540;
  --base-right:320;
  --base-gap:16;
  min-width: calc(var(--base-left)*1px + var(--base-center)*1px + var(--base-right)*1px + 2*var(--base-gap));

  /* full-bleed t·ªõi m√©p viewport */
  margin-left:  calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
  padding-left: 0 !important;
  padding-right: 0 !important;
  column-gap: var(--gap);
}
.left-rail, .right-rail{ margin:0 !important; }

/* G√°n khu v·ª±c cho 3 c·ªôt */
.left-rail  { grid-area:left;  overflow:auto; max-height: calc(100dvh - var(--header-h) - var(--gap)); }
.center-rail{ grid-area:center; min-width:0; display:grid; place-items:center; }
.right-rail { grid-area:right; overflow:auto; max-height: calc(100dvh - var(--header-h) - var(--gap)); display:flex; flex-direction:column; gap: var(--gap); }

/* ·∫®n thanh cu·ªôn x·∫•u (webkit) nh∆∞ng v·∫´n cu·ªôn */
.left-rail::-webkit-scrollbar,
.right-rail::-webkit-scrollbar { width: 8px; }
.left-rail::-webkit-scrollbar-track,
.right-rail::-webkit-scrollbar-track { background: transparent; }
.left-rail::-webkit-scrollbar-thumb,
.right-rail::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,.15);
  border-radius: 8px;
}

/* =======================
   LEFT PANEL (How-to)
   ======================= */
.left-rail{
  background: var(--surface);
  border:2px solid #000; border-radius: var(--radius);
  padding:12px; box-shadow: var(--shadow);
}
.rail-title{
  display:flex; align-items:center; gap:8px;
  margin:4px 0 8px; font-weight:800; font-size:1.25rem;
}
.howto{ overflow:auto; height: calc(100% - 44px); padding-right:6px; }
.howto .howto-sec{ margin-bottom:14px; }
.howto .howto-list{ margin:6px 0 0 18px; line-height:1.55; color:#243; }

/* =======================
   GAME STAGE (CENTER)
   ======================= */
.game-stage{
  position:relative;
  height:100%;
  width:auto;
  max-width:100%;
  aspect-ratio:3/4;
  background:var(--surface);
  border:2px solid #000; border-radius:var(--radius);
  box-shadow:var(--shadow);
  overflow:hidden; z-index:0;
}
.game-stage canvas{ position:absolute; inset:0; }

/* HUD */
.hud{ position:absolute; left:12px; top:10px; display:flex; gap:10px; align-items:flex-start; flex-wrap:wrap; }
.hud .pill{
  min-width:76px; padding:8px 10px; border:2px solid #000; border-radius:999px;
  background:#fff; box-shadow: var(--shadow); font-weight:700;
  display:inline-flex; align-items:center; gap:8px;
}
.hud .ghost{ opacity:.85; }
.top-right{ position:absolute; right:12px; top:10px; }
.btn.circle{ width:44px; height:44px; border-radius:999px; }

.combo{ position:absolute; left:50%; top:62px; transform:translateX(-50%); width:min(92%,520px); pointer-events:none; }
.combo.hidden{ display:none; }
.combo-bar{ width:100%; height:10px; border:2px solid #000; border-radius:999px; background:#fff; overflow:hidden; }
#comboFill{ display:block; height:100%; width:0%; background:linear-gradient(90deg,#16a34a,#facc15); }
.combo-label{ margin-top:6px; font-weight:800; text-align:center; text-shadow:0 2px 12px rgba(0,0,0,.25); }

.toast{ position:absolute; left:50%; top:10px; transform:translateX(-50%);
  border:2px solid #000; background:#111827; color:#fff; padding:8px 12px; border-radius:10px; font-weight:800;
}
.toast.hidden{ display:none; }

.overlay{ position:absolute; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.22); }
.overlay.hidden{ display:none; }
.overlay .row{ display:flex; gap:10px; }

/* =======================
   RIGHT PANELS
   ======================= */
.panel{
  background:#fff; border:2px solid #000; border-radius:14px;
  box-shadow:var(--shadow); padding:12px;
}
.panel-title{ display:flex; align-items:center; gap:8px; margin:0 0 8px; font-weight:800; font-size:1.2rem; }
.panel .ico{ width:18px; height:18px; display:inline-block; }

/* =======================
   ICONS (coin) & HUD coin (+run)
   ======================= */
.hud .hud-coins{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:8px 12px;
  border:2px solid #000;
  border-radius:999px;
  background:#fff;
  box-shadow: var(--shadow);
  font-weight:800;
  min-width:auto;
  line-height:1;
}
.hud .hud-coins.ghost{ opacity:.55; }

/* ƒê·ªìng xu v√†ng d√πng chung (cho HUD & Shop) */
.coin-icon{
  width:18px; height:18px; border-radius:50%;
  display:inline-block;
  border:2px solid #000;
  background:
    radial-gradient(circle at 35% 35%, #fff7c2 0 30%, transparent 31%),
    radial-gradient(circle at 65% 65%, #ffd95a 0 40%, #ffca2b 41% 70%, #f0b100 71% 100%);
  box-shadow: inset 0 0 0 2px rgba(0,0,0,.05);
}

/* =======================
   SHOP
   ======================= */
.shop-coins{
  display:flex; align-items:center; gap:10px;
  padding:8px 10px; margin-bottom:10px;
  border:2px solid #000; border-radius:999px; background:#fff;
  font-weight:800; width:max-content;
}
.shop-coins .label{ margin-right:2px; color:#111; }
.shop-coins .coin-text{ min-width:28px; text-align:right; }

.shop-list{ display:flex; flex-direction:column; gap:10px; }
.shop-item{
  display:flex; align-items:center; justify-content:space-between;
  padding:10px; border:2px solid #000; border-radius:12px; background:#fff;
}
.shop-item .meta{ display:flex; align-items:center; gap:10px; }
.shop-item .meta .title{ font-weight:800; }
.shop-item .meta .desc{ color:var(--muted); font-size:.92rem; }
.shop-item .actions{ display:flex; gap:8px; }
.btn-buy, .btn-equip, .btn-unequip{
  border:2px solid #000; border-radius:10px; padding:6px 10px; font-weight:700; cursor:pointer; background:#fff;
}
.btn-buy{ background:#fffbe6; }
.btn-equip{ background:#e8fff5; }
.btn-unequip{ background:#ffecec; }

/* =======================
   UTILITIES & SMALL ICONS
   ======================= */
.ico.book::before{ content:"üìò"; }
.ico.flag::before{ content:"üèÅ"; }
.ico.cart::before{ content:"üõí"; }

/* ================== HUD BEAUTY: Boss & Mission ================== */
.hud-boss{
  display:inline-flex; align-items:center; gap:10px;
  padding:8px 12px; min-width:220px;
  border:2px solid #000; border-radius:999px; background:#fff;
  box-shadow: var(--shadow);
}
.boss-badge{
  font-weight:800; letter-spacing:.06em; text-transform:uppercase;
  padding:4px 10px; border-radius:999px;
  background:linear-gradient(135deg,#ffe2e2,#ffffff 55%);
  border:2px solid #000;
  box-shadow: 0 0 18px rgba(255,107,107,.35), 0 0 40px rgba(255,107,107,.2);
}
.boss-time{ position:relative; flex:1 1 auto; height:10px; border:2px solid #000; border-radius:999px; background:#fff; overflow:hidden; }
.boss-time .bar{ position:absolute; inset:0; width:100%;
  background:linear-gradient(90deg, var(--boss-accent, #ff6b6b), #ffd1d1);
  box-shadow: 0 0 12px rgba(255,107,107,.5);
  transition: width .15s ease-out;
}
.boss-sec{ font-weight:800; min-width:46px; text-align:right; }

/* ƒë·ªïi accent theo body class */
body.boss-mode { --boss-accent:#ff6b6b; }
body.boss-thunder { --boss-accent:#f5e34b; }
body.boss-dragon  { --boss-accent:#ff8a3d; }

/* Mission pill (tr√™n HUD) */
.hud-mission{
  display:inline-flex; align-items:center; gap:8px;
  padding:8px 12px; border:2px solid #000; border-radius:999px; background:#fff; box-shadow: var(--shadow);
  font-weight:800;
}
.hud-mission .mis-bar{ width:120px; height:8px; border:2px solid #000; border-radius:999px; background:#fff; overflow:hidden; }
.hud-mission .mis-fill{ height:100%; width:0%; background:linear-gradient(90deg,#16a34a,#facc15); transition: width .15s ease; }

/* tiny blink khi d√πng skill ‚Äì ƒë∆∞·ª£c HUD.usePowerBlink() g·ªçi */
@keyframes powerBlink { 0%,100%{ filter:none } 50%{ filter:brightness(1.15) } }

/* ================== SETTINGS OVERLAY (menu ch·ªânh SFX/Music) ================== */
#settingsOverlay{
  position:fixed; inset:0; z-index:9999;
  background:rgba(10,10,12,.58);
  backdrop-filter: blur(3px);
  display:grid; place-items:center;
}
#settingsOverlay.hidden{ display:none; }
.settings-panel{
  width:min(560px, 92vw);
  background:#fff; color:#111;
  border:2px solid #000; border-radius:16px;
  box-shadow: 0 24px 64px rgba(0,0,0,.35);
  padding:16px 18px;
}
.settings-title{ font-weight:800; font-size:1.2rem; margin:2px 0 6px; }
.settings-row{ display:grid; grid-template-columns: 120px 1fr 64px; gap:10px; align-items:center; margin:10px 0; }
.settings-row input[type="range"]{ width:100%; }
.settings-actions{ display:flex; justify-content:flex-end; margin-top:10px; }
#btnCloseSettings{
  height:36px; border:2px solid #000; border-radius:999px; background:#fff; padding:0 14px; font-weight:700; cursor:pointer;
}
#btnCloseSettings:hover{ transform: translateY(-1px); }

/* ===== Boss WARNING flash (to√†n m√†n h√¨nh, ng·∫Øn) ===== */
#bossWarn.boss-warning{
  position:fixed; inset:0; z-index:9998; pointer-events:none;
  display:grid; place-items:center;
  opacity:0; transition: opacity .12s ease;
}
#bossWarn.active{ opacity:1; }
#bossWarn.hidden{ display:none; }

#bossWarn::before, #bossWarn::after{
  content:""; position:absolute; left:0; right:0; height:8px;
  background:
    repeating-linear-gradient(90deg, rgba(255,255,255,.3) 0 18px, transparent 18px 36px),
    linear-gradient(180deg, rgba(255,255,255,.9), rgba(255,255,255,.4));
  filter: drop-shadow(0 6px 8px rgba(0,0,0,.35));
  animation: warnStripe 0.6s linear infinite;
}
#bossWarn::before{ top:0; }
#bossWarn::after { bottom:0; }

#bossWarn .bw-inner{
  padding: 18px 26px;
  border: 3px solid #000; border-radius: 18px;
  background: #fff;
  box-shadow: 0 16px 48px rgba(0,0,0,.35);
  text-align:center;
  transform: scale(.96);
  animation: warnPop .28s ease forwards, warnPulse .9s ease-in-out infinite;
}
#bossWarn .bw-title{
  font-weight: 900; font-size: clamp(28px, 5vw, 44px);
  letter-spacing: .14em; text-transform: uppercase;
  margin-bottom: 6px;
}
#bossWarn .bw-sub{
  font-weight:800; font-size: clamp(16px, 3.5vw, 22px);
  opacity:.9;
}

/* Accent theo lo·∫°i boss */
#bossWarn.type-ufo .bw-inner  { outline: 6px solid rgba(255,107,107,.4); box-shadow: 0 16px 48px rgba(255,107,107,.35); }
#bossWarn.type-thunder .bw-inner{ outline: 6px solid rgba(245,227,75,.4);  box-shadow: 0 16px 48px rgba(245,227,75,.35); }
#bossWarn.type-dragon .bw-inner { outline: 6px solid rgba(255,138,61,.4);  box-shadow: 0 16px 48px rgba(255,138,61,.35); }

/* Animations */
@keyframes warnStripe { to { background-position-x: 36px, 0; } }
@keyframes warnPop   { to { transform: scale(1); } }
@keyframes warnPulse {
  0%,100% { filter: none; }
  50%     { filter: brightness(1.08) contrast(1.02); }
}

/* === MISSION PANEL PROGRESS BAR (panel b√™n ph·∫£i) === */
#panelMissions .bar{
  width:100%; height:8px;
  margin-top:6px;
  border:2px solid #000; border-radius:999px;
  background:#fff; overflow:hidden;
}
#panelMissions .bar > span{
  display:block; height:100%; width:0%;
  background:linear-gradient(90deg,#16a34a,#facc15);
  transition: width .15s ease;
}
#panelMissions .mis-row{
  display:grid; grid-template-columns: 1fr auto;
  gap:8px; padding:6px 0; align-items:center;
  border-bottom:1px dashed rgba(0,0,0,.1);
}
#panelMissions .mis-row .l{ font-weight:600; }
#panelMissions .mis-row .r{ font-weight:700; }

/* === SETTINGS (h·ªó tr·ª£ markup .modal/.modal-card/.slider m√† index.html ƒëang d√πng) === */
#settingsOverlay.modal{
  position: fixed; inset: 0; z-index: 9999;
  display: grid; place-items: center;
  background: rgba(10,10,12,.58);
  backdrop-filter: blur(3px);
}
#settingsOverlay.hidden{ display: none; }

#settingsOverlay .modal-card{
  width: min(560px, 92vw);
  background: #fff; color: #111;
  border: 2px solid #000; border-radius: 16px;
  box-shadow: 0 24px 64px rgba(0,0,0,.35);
  padding: 16px 18px;
}

#settingsOverlay .modal-card .row{
  display: flex; justify-content: flex-start; gap: 10px; margin-top: 10px;
}

#settingsOverlay .slider{
  display: grid;
  grid-template-columns: 140px 1fr 64px;
  align-items: center;
  gap: 10px;
  margin: 10px 0;
}
#settingsOverlay .slider input[type="range"]{ width: 100%; }

/* ======================================================
   SHOP SKIN ICONS (th√™m m·ªõi) ‚Äì d√πng v·ªõi .shop-ico + .ico-*
   ====================================================== */
.shop-ico{
  width:36px; height:36px; border:2px solid #000; border-radius:10px;
  background:#fff; position:relative; flex:0 0 auto;
  display:inline-block;
  box-shadow: inset 0 0 0 2px rgba(0,0,0,.04);
}

/* --- Player: Yakuza --- */
.shop-ico.ico-player-yakuza{
  background:
    linear-gradient(#111 0 55%, #222 55% 100%); /* vest ƒëen */
}
.shop-ico.ico-player-yakuza::before{ /* k√≠nh ƒëen */
  content:""; position:absolute; left:5px; right:5px; top:9px; height:8px;
  background:#0a0a0a; border:2px solid #000; border-radius:6px;
}
.shop-ico.ico-player-yakuza::after{ /* g·∫≠y b√≥ng ch√†y */
  content:""; position:absolute; width:18px; height:6px; right:2px; bottom:6px;
  background:#caa472; border:2px solid #000; border-radius:6px;
  transform: rotate(-18deg);
}

/* --- Player: Superman --- */
.shop-ico.ico-player-superman{
  background:
    linear-gradient(#2f6df6 0 60%, #2a5bd0 60% 100%); /* suit xanh */
}
.shop-ico.ico-player-superman::before{ /* cape m√©p */
  content:""; position:absolute; left:2px; right:2px; bottom:4px; height:10px;
  background:#c51e1e; border:2px solid #000; border-radius:8px;
  transform: skewX(-6deg);
}
.shop-ico.ico-player-superman::after{ /* logo S kim c∆∞∆°ng t·ªëi gi·∫£n */
  content:""; position:absolute; left:50%; top:50%;
  width:14px; height:14px; transform: translate(-50%,-50%) rotate(45deg);
  background:#ffd34d; border:2px solid #000;
  box-shadow: inset 0 0 0 2px #c51e1e;
}

/* --- Obstacle: Orc --- */
.shop-ico.ico-ob-orc{
  background:#3aa652; border-color:#000;
}
.shop-ico.ico-ob-orc::before{ /* ƒë·∫ßu orc */
  content:""; position:absolute; left:6px; top:6px; width:22px; height:22px;
  background:#3aa652; border:2px solid #2B2D42; border-radius:50%;
  box-shadow: inset 0 -2px 0 0 rgba(0,0,0,.15);
}
.shop-ico.ico-ob-orc::after{ /* m·∫Øt */
  content:""; position:absolute; left:11px; top:14px; width:3px; height:3px;
  background:#111; border-radius:50%;
  box-shadow: 6px 0 0 #111;
}

/* --- Obstacle: Slime (Green / Devil / Angel) --- */
.shop-ico[class*="ico-ob-slime"]{
  background:#c9f7ff;
}
.shop-ico.ico-ob-slime-green::before,
.shop-ico.ico-ob-slime-devil::before,
.shop-ico.ico-ob-slime-angel::before{
  content:""; position:absolute; left:5px; right:5px; bottom:6px; height:18px;
  background:#7fffb3; border:2px solid #2B2D42; border-radius:12px 12px 10px 10px;
}

/* devil: s·ª´ng v√† m√†u h∆°i ƒë·ªè */
.shop-ico.ico-ob-slime-devil::before{ background:#ff9ca1; }
.shop-ico.ico-ob-slime-devil::after{
  content:""; position:absolute; left:8px; top:6px; width:0; height:0;
  border-left:6px solid transparent; border-right:6px solid transparent; border-bottom:10px solid #d94646;
  filter: drop-shadow(10px 0 0 #d94646);
}

/* angel: halo v√†ng */
.shop-ico.ico-ob-slime-angel::before{ background:#c9f7ff; }
.shop-ico.ico-ob-slime-angel::after{
  content:""; position:absolute; left:50%; top:6px; transform:translateX(-50%);
  width:16px; height:8px; border:2px solid #ffd166; border-radius:999px; background:#fff8;
}

/* m·∫Øt slime (d√πng chung) */
.shop-ico[class*="ico-ob-slime"] .eyes{
  position:absolute; left:12px; top:16px; width:3px; height:3px; background:#111; border-radius:50%;
  box-shadow: 8px 0 0 #111;
}
.shop-ico[class*="ico-ob-slime"]{ position:relative; }
.shop-ico[class*="ico-ob-slime"]::marker{ content:none; } /* avoid list dots */

/* T·∫°o m·∫Øt b·∫±ng ph·∫ßn t·ª≠ ph·ª• (t·ª± ƒë·ªông) */
.shop-ico[class*="ico-ob-slime"]::before{ /* body ƒë√£ set ·ªü tr√™n */ }
.shop-ico[class*="ico-ob-slime"]::after{ /* ph·ª• ki·ªán bi·∫øn th·ªÉ */ }
.shop-ico[class*="ico-ob-slime"]::after,
.shop-ico[class*="ico-ob-slime"]::before{ pointer-events:none; }
.shop-ico[class*="ico-ob-slime"]{ 
  /* inject pseudo 'eyes' via outline-shadow trick */
}
.shop-item .shop-ico{ position:relative; }
.shop-item .shop-ico > i{
  position:absolute; left:12px; top:16px; width:3px; height:3px; background:#111; border-radius:50%;
  box-shadow: 8px 0 0 #111;
}
/* ----- SHOP TABS (th√™m m·ªõi) ----- */
.shop-tabs{
  display:flex; gap:8px; margin:8px 0 10px;
}
.shop-tab{
  border:2px solid #000; border-radius:999px; background:#fff; padding:6px 12px;
  font-weight:800; cursor:pointer;
}
.shop-tab.active{
  background:#fff1c9;
}

/* ----- ICONS B·ªî SUNG CHO ITEM C≈® ----- */
/* Player basic */
.shop-ico.ico-player-blue{
  background: linear-gradient(#4f80ff 0 60%, #3a68e0 60% 100%);
}
.shop-ico.ico-player-red{
  background: linear-gradient(#ff5b5b 0 60%, #e04040 60% 100%);
}
.shop-ico.ico-player-panda{
  background:
    radial-gradient(circle at 26% 32%, #000 0 6px, transparent 7px),
    radial-gradient(circle at 74% 32%, #000 0 6px, transparent 7px),
    linear-gradient(#fff 0 60%, #ededed 60% 100%);
  overflow:hidden;
}
.shop-ico.ico-player-panda::after{
  content:""; position:absolute; left:8px; right:8px; bottom:6px; height:6px;
  background:#000; border-radius:6px;
}

/* Obstacle basic */
.shop-ico.ico-ob-pastel{
  background:
    linear-gradient(135deg,#ffdede 0 50%, #def7ff 50% 100%);
}
.shop-ico.ico-ob-neon{
  background:
    radial-gradient(circle at 30% 30%, #0ff 0 14px, transparent 15px),
    radial-gradient(circle at 70% 70%, #f0f 0 14px, transparent 15px),
    #111;
}

/* Slime chung (icon t·ªïng) */
.shop-ico.ico-ob-slime{
  background:#c9f7ff;
}
.shop-ico.ico-ob-slime::before{
  content:""; position:absolute; left:5px; right:5px; bottom:6px; height:18px;
  background:#7fffb3; border:2px solid #2B2D42; border-radius:12px 12px 10px 10px;
}
.shop-ico.ico-ob-slime::after{
  content:""; position:absolute; left:12px; top:16px; width:3px; height:3px; background:#111; border-radius:50%;
  box-shadow: 8px 0 0 #111;
}

/* (gi·ªØ nguy√™n c√°c ICON ƒë√£ th√™m tr∆∞·ªõc ƒë√≥: yakuza/superman/orc/slime-variants ‚Ä¶) */

/* ============================= */
/* SHOP ‚Äì TITLE CLAMP + N√öT SAFE */
/* ============================= */

/* Cho .meta chi·∫øm ph·∫ßn c√≤n l·∫°i, tr√°nh ƒë·∫©y n√∫t tr√†n */
.shop-item { align-items:flex-start; gap:12px; }
.shop-item .meta { flex: 1 1 auto; min-width: 0; display:flex; align-items:center; gap:10px; }

/* Ti√™u ƒë·ªÅ 2 d√≤ng thay v√¨ 1: kh√¥ng c√≤n "..." qu√° s·ªõm */
.shop-item .meta .title{
  font-weight:800;
  display: -webkit-box;
  -webkit-line-clamp: 2;         /* T·ªëi ƒëa 2 d√≤ng */
  -webkit-box-orient: vertical;
  overflow: hidden;
  white-space: normal;
  line-height: 1.15;
  max-width: 68%;
}

/* M√¥ t·∫£ x√°m nh·∫π, kh√¥ng chi·∫øm ch·ªó c·ªßa title */
.shop-item .meta .desc{ color: var(--muted); font-size: .92rem; }

/* Khu n√∫t: cho ph√©p xu·ªëng d√≤ng khi h·∫πp, ko tr√†n panel */
.shop-item .actions{
  flex:0 0 auto; display:flex; gap:8px;
  justify-content:flex-end; align-items:center;
  flex-wrap:wrap;
  max-width: 38%;
}
@media (max-width: 980px){
  .shop-item .actions{ max-width:100%; }
}

/* N√∫t g·ªçn v√† responsive */
.btn-buy, .btn-equip, .btn-unequip{
  white-space: nowrap; padding: 7px 12px; max-width: 100%;
  border-radius: 12px;
  transition: transform .08s ease, box-shadow .12s ease, background .12s ease;
}
.btn-buy:hover, .btn-equip:hover, .btn-unequip:hover{ transform: translateY(-1px); }
.btn-buy:active, .btn-equip:active, .btn-unequip:active{ transform: translateY(0); }
.btn-equip:disabled{ opacity: .65; cursor: default; filter: saturate(.85); box-shadow:none; transform:none; }

/* ============================= */
/* D·ªåN ‚ÄúEMPTY RULESETS‚Äù ‚Äì SLIME  */
/* ============================= */
/* Thay block slime icon b·ªã l·∫∑p/ƒë·ªÉ tr·ªëng b·∫±ng nh√≥m g·ªçn d∆∞·ªõi:
   (N·∫øu tr∆∞·ªõc ƒë√≥ c√≥ c√°c rule .shop-ico[class*="ico-ob-slime"] { } ch·ªâ ch·ª©a comment,
    b·∫°n c√≥ th·ªÉ x√≥a ch√∫ng; b·∫£n d∆∞·ªõi ƒë√£ ƒë·ªß hi·ªÉn th·ªã m·∫Øt + bi·∫øn th·ªÉ.) */

.shop-ico[class*="ico-ob-slime"]{
  position: relative;
  background:#c9f7ff;
}
.shop-ico.ico-ob-slime::before,
.shop-ico.ico-ob-slime-green::before,
.shop-ico.ico-ob-slime-devil::before,
.shop-ico.ico-ob-slime-angel::before{
  content:""; position:absolute; left:5px; right:5px; bottom:6px; height:18px;
  background:#7fffb3; border:2px solid #2B2D42; border-radius:12px 12px 10px 10px;
}
/* bi·∫øn th·ªÉ */
.shop-ico.ico-ob-slime-devil::before{ background:#ff9ca1; }     /* ƒë·ªè h·ªìng */
.shop-ico.ico-ob-slime-angel::before{ background:#c9f7ff; }     /* xanh nh·∫°t */

/* ph·ª• ki·ªán bi·∫øn th·ªÉ */
.shop-ico.ico-ob-slime-devil::after{
  content:""; position:absolute; left:8px; top:6px; width:0; height:0;
  border-left:6px solid transparent; border-right:6px solid transparent; border-bottom:10px solid #d94646;
  filter: drop-shadow(10px 0 0 #d94646);
}
.shop-ico.ico-ob-slime-angel::after{
  content:""; position:absolute; left:50%; top:6px; transform:translateX(-50%);
  width:16px; height:8px; border:2px solid #ffd166; border-radius:999px; background:#fff8;
}

/* ‚Äúm·∫Øt‚Äù chung cho m·ªçi slime */
.shop-item .shop-ico > i,
.shop-ico[class*="ico-ob-slime"] .eyes{
  position:absolute; left:12px; top:16px; width:3px; height:3px; background:#111; border-radius:50%;
  box-shadow: 8px 0 0 #111;
}

/* ============================= */
/* POLISH T·ªîNG TH·ªÇ ‚Äì NH·∫∏ NH√ÄNG  */
/* ============================= */

/* Panel & item hover ƒë·ªìng b·ªô, kh√¥ng ph√° layout */
.panel, .shop-item { transition: box-shadow .15s ease, transform .12s ease; }
.shop-item:hover   { box-shadow: 0 10px 26px rgba(0,0,0,.16); }
.panel:hover       { box-shadow: 0 12px 30px rgba(0,0,0,.16); }

/* Focus ring nh·∫•t qu√°n khi d√πng Tab */
.select:focus-visible, .btn:focus-visible,
.btn-buy:focus-visible, .btn-equip:focus-visible, .btn-unequip:focus-visible {
  outline: 3px solid #111; outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(0,0,0,.12);
}

/* Nh·∫π nh√†ng n√¢ng tone (c√≥ th·ªÉ ƒë·ªïi nhanh t·∫°i 2 bi·∫øn d∆∞·ªõi) */
:root{ --brand: #0ea5b7; --accent:#ffd166; }
.btn-reset:hover{ background:#ffe9c9; }
/* === SHOP: b·ªë c·ª•c text an to√†n, kh√¥ng ch√®n nhau === */
.shop-item .meta{
  display:grid;
  grid-template-columns: 42px 1fr;                /* icon | text */
  grid-template-areas: "ico title" "ico desc";   /* 2 h√†ng: title & desc */
  align-items:center;
  gap:8px 12px;
  flex: 1 1 auto; min-width:0;
}
.shop-item .shop-ico{ grid-area: ico; }

.shop-item .meta .title{
  grid-area: title;
  font-weight:800;
  display:-webkit-box;
  -webkit-line-clamp:2;              /* t·ªëi ƒëa 2 d√≤ng thay v√¨ 1 */
  -webkit-box-orient:vertical;
  overflow:hidden;
  white-space:normal;
  line-height:1.15;
}

.shop-item .meta .desc{
  grid-area: desc;
  color: var(--muted);
  font-size:.92rem;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* v√πng n√∫t gi·ªØ g·ªçn v√† kh√¥ng tr√†n */
.shop-item .actions{
  flex:0 0 auto; display:flex; gap:8px;
  justify-content:flex-end; align-items:center;
  flex-wrap:wrap; max-width:38%;
}
@media (max-width: 980px){
  .shop-item .actions{ max-width:100%; }
}

/* =========================
   POWER LOGO (ƒë·∫≠m ‚Äì n·ªïi b·∫≠t)
   ========================= */
:root{
  --brand1:#ffdda6;      /* header bg */
  --brand2:#ffd166;      /* warm accent */
  --brand3:#22d3ee;      /* neon cyan */
  --brand4:#a78bfa;      /* neon purple */
  --ink:#101317;         /* text ink */
}

.topbar{
  position:relative; overflow:hidden;
  background: linear-gradient(180deg, var(--brand1) 0%, #ffe5b9 100%);
  box-shadow: inset 0 -2px 0 rgba(0,0,0,.65);
}

/* Logo: gradient + vi·ªÅn gi·∫£ + ph√°t s√°ng m·∫°nh h∆°n */
.logo{
  position:relative;
  padding: 12px 16px 14px;
  font-weight: 950;
  letter-spacing:.6px;
  line-height:1;
  color: transparent;
  background:
    linear-gradient(90deg, #fff 0%, #f3f3f3 20%, #d9e7ff 60%, #ffffff 100%) no-repeat;
  -webkit-background-clip: text; background-clip: text;

  /* vi·ªÅn ch·ªØ n·ªïi (stroke gi·∫£) + glow */
  text-shadow:
    0 0 0 #111,
    0 1px 0 #111,
    0 2px 0 #111,
    0 3px 0 #111,
    0 6px 14px rgba(0,0,0,.28),
    0 0 18px rgba(34,211,238,.6);
}

/* shine ch·∫°y qua ch·ªØ ‚Äì r√µ r√†ng h∆°n */
.logo::after{
  content:"";
  position:absolute; inset:0; left:-35%;
  background: linear-gradient(75deg, transparent 0%, rgba(255,255,255,.9) 48%, transparent 52%);
  transform: skewX(-16deg);
  animation: logoShine 3.6s ease-in-out infinite;
  mix-blend-mode:screen; pointer-events:none;
}
@keyframes logoShine{
  0%{ left:-40%; opacity:.0 }
  10%{ opacity:.9 }
  55%{ left:115%; opacity:.0 }
  100%{ left:115%; opacity:.0 }
}

/* g·∫°ch d∆∞·ªõi neon nh·ªãp r√µ h∆°n */
.logo::before{
  content:"";
  position:absolute; left:16px; bottom:-10px; height:5px;
  width:180px; max-width:calc(100% - 32px);
  background: linear-gradient(90deg, var(--brand3), var(--brand4));
  border-radius:999px;
  box-shadow:
    0 0 12px var(--brand3),
    0 0 22px var(--brand4),
    0 8px 20px rgba(0,0,0,.18);
  animation: underlinePulse 1.5s ease-in-out infinite;
}
@keyframes underlinePulse{
  0%,100%{ transform: scaleX(.82); filter:brightness(1); }
  50%    { transform: scaleX(1);    filter:brightness(1.25); }
}

/* ==============================
   VI·ªÄN CANVAS ‚Äì GLOW + ORBIT r√µ
   ============================== */
/* L∆ØU √ù: pseudo-element ƒë·∫∑t tr√™n ch√≠nh canvas, kh√¥ng c·∫ßn wrapper */
#gameCanvas{
  position:relative; z-index: 0;
  border-radius: 18px;
  border: 3px solid transparent;    /* ƒë·ªÉ t·∫°o khe cho vi·ªÅn ph√°t s√°ng */
  background-clip: padding-box;     /* kh√¥ng cho n·ªÅn ƒë√® vi·ªÅn */
  box-shadow: 0 16px 48px rgba(0,0,0,.28);
  outline:none;
}

/* Vi·ªÅn conic ch·∫°y quanh (r√µ, ƒë·∫≠m) */
#gameCanvas::before{
  content:"";
  position:absolute; inset:-3px; border-radius:20px; pointer-events:none;
  --angle: 0deg;
  background:
    conic-gradient(from var(--angle),
      rgba(34,211,238,.0) 0deg,
      rgba(34,211,238,.9) 90deg,
      rgba(167,139,250,.95) 180deg,
      rgba(34,211,238,.9) 270deg,
      rgba(34,211,238,.0) 360deg);
  animation: orbitSpin 5.2s linear infinite;
  /* kho√©t r·ªóng gi·ªØa ƒë·ªÉ ch·ªâ c√≤n vi·ªÅn ph√°t s√°ng */
  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite: xor;
          mask-composite: exclude;
  padding:3px;                       /* ƒë·ªô d√†y vi·ªÅn glow */
  filter: drop-shadow(0 0 10px rgba(34,211,238,.65))
          drop-shadow(0 0 18px rgba(167,139,250,.5));
}
@keyframes orbitSpin{
  to{ --angle: 360deg; }
}

/* L·ªõp ‚Äúsurface glow‚Äù v√† bracket g√≥c (r√µ h∆°n) */
#gameCanvas::after{
  content:"";
  position:absolute; inset:0; border-radius:18px; pointer-events:none;
  background:
    linear-gradient(#0b0d11, #0b0d11) top left     / 28px 2px no-repeat,
    linear-gradient(#0b0d11, #0b0d11) top left     / 2px 28px no-repeat,
    linear-gradient(#0b0d11, #0b0d11) top right    / 28px 2px no-repeat,
    linear-gradient(#0b0d11, #0b0d11) top right    / 2px 28px no-repeat,
    linear-gradient(#0b0d11, #0b0d11) bottom left  / 28px 2px no-repeat,
    linear-gradient(#0b0d11, #0b0d11) bottom left  / 2px 28px no-repeat,
    linear-gradient(#0b0d11, #0b0d11) bottom right / 28px 2px no-repeat,
    linear-gradient(#0b0d11, #0b0d11) bottom right / 2px 28px no-repeat,
    radial-gradient(120% 80% at 50% 20%, rgba(255,255,255,.12), transparent 60%);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);
  mix-blend-mode: normal;
}

/* Focus ring khi ng∆∞·ªùi ch∆°i click v√†o canvas */
#gameCanvas:focus-visible{
  box-shadow:
    0 0 0 3px rgba(0,0,0,.6),
    0 0 0 7px rgba(34,211,238,.6),
    0 16px 48px rgba(0,0,0,.28);
}

/* Respect user ‚Äì gi·∫£m chuy·ªÉn ƒë·ªông n·∫øu c·∫ßn */
@media (prefers-reduced-motion: reduce){
  .logo::after, .logo::before, .topbar::before,
  #gameCanvas::before{ animation:none !important; }
}
