<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Avoid Boxes ‚Äì Funny Edition</title>
  <link rel="stylesheet" href="css/style.css" />
  <!-- Game UI fonts (VN + KR ready) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jua&family=Be+Vietnam+Pro:wght@400;600;700;800;900&display=swap" rel="stylesheet">

  <!-- Leaderboard dropdown styles (t√°ch kh·ªèi style.css ƒë·ªÉ d√°n d·ªÖ) -->
  <style>
    .lb-dropdown{
      position:fixed; z-index:9999; /* lu√¥n n·ªïi */
      top:76px; right:16px;
      width:320px; max-height:60vh; overflow:auto;
      background:var(--surface,#f7ede2);
      border:2px solid #000; border-radius:14px;
      box-shadow:var(--shadow,0 8px 24px rgba(0,0,0,.35));
      padding:10px; color:var(--ink,#111)
    }
    .lb-dropdown.hidden{ display:none } /* M·∫∂C ƒê·ªäNH ·∫®N */
    .lb-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom:6px }
    .lb-head strong{ font-size:16px }
    .lb-list{ margin:6px 0 8px; padding-left:18px }
    .lb-list li{ margin:4px 0; line-height:1.25 }
    .lb-foot{ display:flex; justify-content:flex-end; gap:8px }
    .btn-xs{ height:28px; padding:0 10px; border:2px solid #000; border-radius:999px; background:#fff; cursor:pointer; font-weight:700 }
    .btn-xs:hover{ transform:translateY(-1px) }
  </style>
</head>
<body>
  <div id="app">
    <header class="topbar">
      <!-- Gi·ªØ nguy√™n logo/hero theo file g·ªëc -->
      <div class="logo-hero">
        <h1 class="logo" id="gameLogo" data-i18n="app.title"></h1>

        <!-- (gi·ªØ nguy√™n mascot n·∫øu c·∫ßn) -->
        <figure class="logo-mascot" aria-hidden="true">
          <svg viewBox="0 0 220 180" width="220" height="180" class="yakuza-svg" role="img">
            <rect x="60" y="120" width="90" height="10" rx="5" fill="#3a3a3a"/>
            <path d="M95 120 Q90 135 100 145 L110 145 Q105 130 115 120 Z" fill="#1e293b"/>
            <path d="M125 120 Q120 135 130 145 L140 145 Q135 130 145 120 Z" fill="#1e293b"/>
            <path d="M85 70 L140 70 L150 115 L75 115 Z" fill="#111"/>
            <path d="M112 70 L116 70 L118 95 L110 95 Z" fill="#b91c1c"/>
            <circle cx="112" cy="52" r="18" fill="#f8d2b1"/>
            <path d="M94 46 Q112 28 130 46 L124 40 Q112 34 100 40 Z" fill="#111"/>
            <rect x="100" y="48" width="12" height="6" rx="2" fill="#0f172a"/>
            <rect x="114" y="48" width="12" height="6" rx="2" fill="#0f172a"/>
            <rect x="112" y="50" width="4" height="2" fill="#0f172a"/>
            <rect x="60" y="92" width="58" height="6" rx="3" fill="#8b5e34" transform="rotate(-10 60 92)"/>
            <circle cx="68" cy="94" r="6" fill="#f8d2b1"/>
            <g class="right-arm" transform="translate(145,88)">
              <rect x="-6" y="-2" width="26" height="6" rx="3" fill="#111"/>
              <g class="forearm" transform="translate(20,0)">
                <rect x="0" y="-2" width="26" height="6" rx="3" fill="#111"/>
                <circle cx="28" cy="1" r="4" fill="#f8d2b1"/>
              </g>
            </g>
          </svg>
        </figure>
      </div>

      <nav class="top-actions">
        <button id="btnReset" class="btn-reset" title="Reset missions/coins/xp">Reset Mission</button>

        <select id="langSelect" class="select" aria-label="Language">
          <option value="en">English</option>
          <option value="ko">ÌïúÍµ≠Ïñ¥</option>
        </select>

        <select id="stageSelect" class="select" aria-label="Stage">
          <option value="city">City</option>
          <option value="noodle">Noodle</option>
          <option value="gym">Gym</option>
        </select>

        <!-- NEW: n√∫t Leaderboard -->
        <button id="btnLeaderboard" class="btn" title="Leaderboard (Top 10)" data-i18n-title="lb.btn_title">üèÜ</button>

        <button id="btnSettings" class="btn" title="Settings" data-i18n-title="header.settings_title">‚öôÔ∏è</button>
        <button id="btnMute" class="btn" aria-pressed="false" title="Sound" data-i18n-title="header.sound_title">üîä</button>
      </nav>

      <!-- NEW: Panel dropdown Top 10 ‚Äî m·∫∑c ƒë·ªãnh ·∫©n -->
      <div id="leaderboardPanel" class="lb-dropdown hidden" aria-hidden="true">
        <div class="lb-head">
          <strong id="lbTitle" data-i18n="lb.title">Top 10 (Local)</strong>
          <button id="btnLbClose" class="btn btn-xs" title="Close" data-i18n="lb.close">‚úï</button>
        </div>
        <ol id="lbList" class="lb-list"></ol>
        <div class="lb-foot">
          <button id="btnLbClear" class="btn btn-xs" title="Clear all" data-i18n="lb.clear">Clear</button>
        </div>
      </div>
    </header>

    <div id="scaleRoot" class="scale-root">
      <main class="main-grid">
        <!-- LEFT -->
        <aside class="left-rail">
          <h2 class="rail-title">
            <span class="ico book" aria-hidden="true"></span>
            <span id="howtoTitle">How to Play</span>
          </h2>
          <div id="howtoBody" class="howto"></div>
        </aside>

        <!-- CENTER -->
        <section class="center-rail">
          <div class="game-stage">
            <canvas id="gameCanvas" width="540" height="720" tabindex="0"></canvas>

            <!-- HUD -->
            <div class="hud top-left">
              <div id="uiTime"  class="pill">‚Äî</div>
              <div id="uiScore" class="pill">‚Äî</div>
              <div id="uiBest"  class="pill ghost">‚Äî</div>
            </div>

            <div id="gameoverStats"></div>
            <button id="btnPause" class="btn circle top-right" aria-label="Pause" data-i18n-aria="buttons.pause_aria">‚è∏</button>

            <!-- Combo -->
            <div id="comboWrap" class="combo hidden">
              <div class="combo-bar"><span id="comboFill"></span></div>
              <div class="combo-label">COMBO <span id="comboCount">0</span> ‚Ä¢ <span id="comboMult">1.00x</span></div>
            </div>

            <div id="toast" class="toast hidden" data-i18n="toast.incoming"></div>

            <!-- Overlays -->
            <div id="overlayStart" class="overlay show">
              <h2 data-i18n="start.title"></h2>
              <p  data-i18n="start.prompt"></p>
              <button id="btnPlay" class="btn big" data-i18n="start.play"></button>
            </div>

            <div id="overlayPause" class="overlay hidden">
              <h2 data-i18n="pause.title"></h2>
              <div class="row">
                <button id="btnResume"   class="btn" data-i18n="pause.resume"></button>
                <button id="btnRestart1" class="btn" data-i18n="pause.restart"></button>
              </div>
            </div>

            <div id="overlayCountdown" class="overlay hidden">
              <h2 id="countNum">3</h2>
            </div>

            <div id="overlayGameOver" class="overlay hidden">
              <h2 data-i18n="gameover.title"></h2>
              <p id="finalResult">‚Äî</p>
              <button id="btnRestart2" class="btn big" data-i18n="gameover.restart"></button>
            </div>

            <!-- Touch -->
            <div class="touch left"  id="touchLeft"  aria-hidden="true"></div>
            <div class="touch right" id="touchRight" aria-hidden="true"></div>
          </div>
        </section>

        <!-- RIGHT -->
        <aside class="right-rail">
          <section class="panel" id="panelMissions">
            <h2 class="panel-title"><span class="ico flag"></span><span data-i18n="panel.missions_title">Today's Missions</span></h2>
            <ul id="missionsList"></ul>
          </section>

          <section class="panel" id="panelShop">
            <h2 class="panel-title"><span class="ico cart"></span><span data-i18n="panel.shop_title">Shop</span></h2>
          </section>
        </aside>
      </main>
    </div>
  </div>

  <!-- Settings modal -->
  <div id="settingsOverlay" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
    <div class="modal-card">
      <h3 id="settingsTitle" data-i18n="settings.title">Settings</h3>
      <label class="slider">
        <span data-i18n="settings.sfx"></span>
        <input id="sfxRange" type="range" min="0" max="100" step="1">
        <span id="sfxVal">90%</span>
      </label>
      <label class="slider">
        <span data-i18n="settings.music"></span>
        <input id="musicRange" type="range" min="0" max="100" step="1">
        <span id="musicVal">30%</span>
      </label>
      <div class="row">
        <button id="btnCloseSettings" class="btn" data-i18n="settings.close"></button>
      </div>
    </div>
  </div>

  <script type="module" src="js/main.js"></script>
</body>
</html>
